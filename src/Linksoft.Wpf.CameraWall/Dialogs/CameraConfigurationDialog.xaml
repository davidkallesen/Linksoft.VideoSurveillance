<atc:NiceWindow
    x:Class="Linksoft.Wpf.CameraWall.Dialogs.CameraConfigurationDialog"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:atc="https://github.com/atc-net/atc-wpf/tree/main/schemas"
    xmlns:atcTranslation="https://github.com/atc-net/atc-wpf/tree/main/schemas/translations"
    xmlns:cameraConfigs="clr-namespace:Linksoft.Wpf.CameraWall.Dialogs.Parts.CameraConfigurations"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:dialogs="clr-namespace:Linksoft.Wpf.CameraWall.Dialogs"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    Title="{Binding Path=DialogTitle}"
    Width="1200"
    Height="1000"
    d:DataContext="{d:DesignInstance Type=dialogs:CameraConfigurationDialogViewModel,
                                     IsDesignTimeCreatable=False}"
    ResizeMode="CanResize"
    ShowInTaskbar="False"
    WindowStartupLocation="CenterOwner"
    WindowStyle="ToolWindow"
    mc:Ignorable="d">

    <atc:NiceWindow.Resources>
        <!--  Network Scanner Template - only instantiated when IsNew is true  -->
        <DataTemplate x:Key="NetworkScannerTemplate">
            <cameraConfigs:NetworkScannerPart />
        </DataTemplate>

        <!--  Empty template for editing mode  -->
        <DataTemplate x:Key="EmptyTemplate" />
    </atc:NiceWindow.Resources>

    <atc:BusyOverlay IsBusy="{Binding Path=IsTesting}">
        <atc:GridEx Rows="*,20,Auto">

            <!--  Scrollable Content Area  -->
            <ScrollViewer
                Grid.Row="0"
                Padding="0,0,20,0"
                HorizontalScrollBarVisibility="Disabled"
                VerticalScrollBarVisibility="Auto">

                <StackPanel Margin="20">

                    <!--  Network Scanner (only instantiated when adding new camera)  -->
                    <ContentControl Content="{Binding}">
                        <ContentControl.Style>
                            <Style TargetType="ContentControl">
                                <Setter Property="ContentTemplate" Value="{StaticResource EmptyTemplate}" />
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding Path=IsNew}" Value="True">
                                        <Setter Property="ContentTemplate" Value="{StaticResource NetworkScannerTemplate}" />
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </ContentControl.Style>
                    </ContentControl>

                    <!--  Form Content - 3 Column Layout  -->
                    <atc:GroupBoxExpander Margin="0,0,0,20" Header="{atcTranslation:Resx ResxName=Linksoft.Wpf.CameraWall.Resources.Translations, Key=CameraConfiguration}">
                        <atc:GridEx
                            Margin="10"
                            Columns="*,20,*,20,*"
                            Rows="Auto">
                            <cameraConfigs:BasicDisplaySettingsPart Grid.Row="0" Grid.Column="0" />
                            <cameraConfigs:BasicConnectionSettingsPart Grid.Row="0" Grid.Column="2" />
                            <cameraConfigs:BasicAuthenticationSettingsPart Grid.Row="0" Grid.Column="4" />
                        </atc:GridEx>
                    </atc:GroupBoxExpander>

                    <!--  Advanced Settings  -->
                    <cameraConfigs:AdvancedStreamSettingsPart Margin="0,0,0,20" />

                    <!--  Camera-Specific Overrides  -->
                    <atc:GroupBoxExpander Header="{atcTranslation:Resx ResxName=Linksoft.Wpf.CameraWall.Resources.Translations, Key=Overrides}">
                        <atc:UniformSpacingPanel
                            Margin="10"
                            Orientation="Vertical"
                            Spacing="20">
                            <!--  Info text  -->
                            <TextBlock
                                FontStyle="Italic"
                                Foreground="{DynamicResource AtcApps.Brushes.Text}"
                                Text="{atcTranslation:Resx ResxName=Linksoft.Wpf.CameraWall.Resources.Translations,
                                                           Key=OverrideSettingsInfo}"
                                TextWrapping="Wrap" />

                            <!--  Display Overrides  -->
                            <cameraConfigs:DisplayOverridesPart />

                            <!--  Connection Overrides  -->
                            <cameraConfigs:ConnectionOverridesPart />

                            <!--  Performance Overrides  -->
                            <cameraConfigs:PerformanceOverridesPart />

                            <!--  Recording Overrides  -->
                            <cameraConfigs:RecordingOverridesPart />

                            <!--  Motion Detection Overrides  -->
                            <cameraConfigs:MotionDetectionOverridesPart />
                        </atc:UniformSpacingPanel>
                    </atc:GroupBoxExpander>

                </StackPanel>
            </ScrollViewer>

            <!--  Test Result | Buttons (sticky at bottom)  -->
            <atc:GridEx
                Grid.Row="2"
                Margin="20"
                Columns="*,20,Auto,40">
                <atc:LabelTextInfo
                    Grid.Column="0"
                    VerticalAlignment="Center"
                    HideAreas="All"
                    LabelText="{atcTranslation:Resx ResxName=Linksoft.Wpf.CameraWall.Resources.Translations,
                                                    Key=TestResult}"
                    Text="{Binding Path=TestResult}" />

                <atc:UniformSpacingPanel
                    Grid.Column="2"
                    VerticalAlignment="Center"
                    Orientation="Horizontal"
                    Spacing="8">
                    <Button
                        MinWidth="80"
                        Padding="16,8"
                        Command="{Binding Path=TestConnectionCommand}"
                        Content="{atcTranslation:Resx ResxName=Linksoft.Wpf.CameraWall.Resources.Translations,
                                                      Key=Test}" />
                    <Button
                        MinWidth="80"
                        Padding="16,8"
                        Command="{Binding Path=SaveCommand}"
                        Content="{atcTranslation:Resx ResxName=Linksoft.Wpf.CameraWall.Resources.Translations,
                                                      Key=Save}"
                        IsDefault="True" />
                    <Button
                        MinWidth="80"
                        Padding="16,8"
                        Command="{Binding Path=CancelCommand}"
                        Content="{atcTranslation:Resx ResxName=Linksoft.Wpf.CameraWall.Resources.Translations,
                                                      Key=Cancel}"
                        IsCancel="True" />
                </atc:UniformSpacingPanel>
            </atc:GridEx>

        </atc:GridEx>
    </atc:BusyOverlay>

</atc:NiceWindow>
