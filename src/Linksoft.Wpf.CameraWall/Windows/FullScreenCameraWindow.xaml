<Window
    x:Class="Linksoft.Wpf.CameraWall.Windows.FullScreenCameraWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:atcTranslation="https://github.com/atc-net/atc-wpf/tree/main/schemas/translations"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:fl="clr-namespace:FlyleafLib.Controls.WPF;assembly=FlyleafLib"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:valueConverters="clr-namespace:Atc.Wpf.ValueConverters;assembly=Atc.Wpf"
    xmlns:windows="clr-namespace:Linksoft.Wpf.CameraWall.Windows"
    Title="{Binding Path=CameraName}"
    d:DataContext="{d:DesignInstance Type=windows:FullScreenCameraWindowViewModel,
                                     IsDesignTimeCreatable=False}"
    AllowsTransparency="False"
    Background="Black"
    ResizeMode="NoResize"
    ShowInTaskbar="True"
    Topmost="True"
    WindowState="Maximized"
    WindowStyle="None"
    mc:Ignorable="d">

    <Window.Resources>
        <ResourceDictionary Source="/Linksoft.Wpf.CameraWall;component/Themes/FullScreenStyles.xaml" />
    </Window.Resources>

    <!--  ReSharper disable Xaml.BindingWithContextNotResolved  -->
    <Grid x:Name="RootGrid">
        <!--  Video Player with visual overlay inside (required due to DirectX airspace)  -->
        <fl:FlyleafHost
            x:Name="VideoPlayer"
            KeyBindings="None"
            Player="{Binding Path=Player}">

            <!--  Visual overlay content - renders on top of video  -->
            <Grid Background="Transparent">
                <!--  Camera Info Overlay (Top-Left)  -->
                <Border
                    x:Name="OverlayBorder"
                    Margin="20"
                    Padding="12,8"
                    HorizontalAlignment="Left"
                    VerticalAlignment="Top"
                    CornerRadius="4"
                    Opacity="{Binding Path=HostDataContext.IsOverlayVisible, Converter={StaticResource BoolToOpacityConverter}}">
                    <StackPanel Orientation="Vertical">
                        <!--  Camera Title  -->
                        <TextBlock
                            FontSize="16"
                            FontWeight="SemiBold"
                            Foreground="White"
                            Text="{Binding Path=HostDataContext.CameraName}"
                            Visibility="{Binding Path=HostDataContext.ShowOverlayTitle, Converter={StaticResource BooleanToVisibilityConverter}}" />
                        <!--  Camera Description (only shown if enabled AND not empty)  -->
                        <TextBlock
                            FontSize="12"
                            Foreground="#AAAAAA"
                            Text="{Binding Path=HostDataContext.CameraDescription}"
                            Visibility="{Binding Path=HostDataContext.ShowOverlayDescription, Converter={StaticResource BooleanToVisibilityConverter}}">
                            <TextBlock.Style>
                                <Style TargetType="TextBlock">
                                    <Style.Triggers>
                                        <DataTrigger Binding="{Binding Path=HostDataContext.CameraDescription}" Value="">
                                            <Setter Property="Visibility" Value="Collapsed" />
                                        </DataTrigger>
                                    </Style.Triggers>
                                </Style>
                            </TextBlock.Style>
                        </TextBlock>
                        <!--  Current Time  -->
                        <TextBlock
                            x:Name="TimeDisplay"
                            FontSize="12"
                            Foreground="#AAAAAA"
                            Visibility="{Binding Path=HostDataContext.ShowOverlayTime, Converter={StaticResource BooleanToVisibilityConverter}}" />
                        <!--  Connection Status  -->
                        <StackPanel
                            Margin="0,4,0,0"
                            Orientation="Horizontal"
                            Visibility="{Binding Path=HostDataContext.ShowOverlayConnectionStatus, Converter={StaticResource BooleanToVisibilityConverter}}">
                            <Ellipse
                                Width="10"
                                Height="10"
                                Margin="0,0,6,0"
                                Fill="{Binding Path=HostDataContext.ConnectionState, Converter={StaticResource ConnectionStateToColorConverter}}" />
                            <TextBlock
                                FontSize="11"
                                Foreground="#AAAAAA"
                                Text="{Binding Path=HostDataContext.ConnectionState, Converter={StaticResource ConnectionStateToTextConverter}}" />
                        </StackPanel>
                    </StackPanel>
                </Border>

                <!--  Close Button (Top-Right)  -->
                <Button
                    Width="40"
                    Height="40"
                    Margin="20"
                    HorizontalAlignment="Right"
                    VerticalAlignment="Top"
                    Command="{Binding Path=HostDataContext.CloseCommand}"
                    Opacity="{Binding Path=HostDataContext.IsOverlayVisible, Converter={StaticResource BoolToOpacityConverter}}"
                    Style="{StaticResource FullScreenCloseButtonStyle}"
                    ToolTip="Close">
                    <Path
                        Width="14"
                        Height="14"
                        Data="M0,0 L14,14 M14,0 L0,14"
                        Stroke="White"
                        StrokeThickness="2" />
                </Button>

                <!--  ESC hint at bottom  -->
                <TextBlock
                    Margin="0,0,0,20"
                    HorizontalAlignment="Center"
                    VerticalAlignment="Bottom"
                    FontSize="12"
                    Foreground="#66FFFFFF"
                    Opacity="{Binding Path=HostDataContext.IsOverlayVisible, Converter={StaticResource BoolToOpacityConverter}}"
                    Text="{atcTranslation:Resx ResxName=Linksoft.Wpf.CameraWall.Resources.Translations,
                                               Key=PressEscToExit}" />
            </Grid>
        </fl:FlyleafHost>
    </Grid>
    <!--  ReSharper restore Xaml.BindingWithContextNotResolved  -->
</Window>
